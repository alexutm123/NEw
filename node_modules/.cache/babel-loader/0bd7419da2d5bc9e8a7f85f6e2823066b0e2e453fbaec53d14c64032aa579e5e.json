{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\user\\\\Documents\\\\GitHub\\\\NEw\\\\src\\\\integrations\\\\ChessPuzzle.js\",\n  _s = $RefreshSig$();\nimport React, { Component, useContext } from \"react\";\nimport PropTypes from \"prop-types\";\nimport { getSquarestoGo, getAllPiecesExceptKnight, moveLikesKnight, updateKnightInPosition, getSquareOfKnight, getInvalidSquaresByPosition } from \"./functions\";\n// import { Chess } from \"chess.js\";\nimport Chessboard from \"chessboardjsx\";\n\n// code extracted and adapted from https://chessboardjsx.com/integrations/move-validation\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nclass ChessPuzzle extends Component {\n  constructor() {\n    super(...arguments);\n    this.state = {\n      position: this.props.exercise.position,\n      squareOfKnight: getSquareOfKnight(this.props.exercise.position),\n      OtherPieces: getAllPiecesExceptKnight(this.props.exercise.position),\n      invalidSquares: getInvalidSquaresByPosition(this.props.exercise.position),\n      squaresToGo: getSquarestoGo(this.props.exercise),\n      actualSquareToGoIndex: 1,\n      squareStyles: {}\n    };\n    this.hasEnded = () => {\n      return this.state.actualSquareToGoIndex === this.state.squaresToGo.length;\n    };\n    this.reset = () => {\n      const position = this.props.exercise.position;\n      const squaresToGo = getSquarestoGo(this.props.exercise);\n      this.setState({\n        position: position,\n        squareOfKnight: getSquareOfKnight(position),\n        OtherPieces: getAllPiecesExceptKnight(position),\n        invalidSquares: getInvalidSquaresByPosition(position),\n        squaresToGo: squaresToGo,\n        actualSquareToGoIndex: 1,\n        squareStyles: {\n          [squaresToGo[1]]: {\n            backgroundColor: \"rgba(255, 255, 0, 0.4)\"\n          }\n        }\n      });\n      this.props.contextExercise.setSquares(\"totalToGo\", squaresToGo.length - 1);\n    };\n    this.allowDrag = _ref => {\n      let {\n        piece\n      } = _ref;\n      // we can only pick up the white knight\n      return piece === \"wN\";\n    };\n    this.moveTheKnight = (sourceSquare, targetSquare) => {\n      if (moveLikesKnight(sourceSquare, targetSquare) && !this.state.invalidSquares.includes(targetSquare)) {\n        this.setState({\n          position: updateKnightInPosition(this.props.exercise.position, targetSquare),\n          squareOfKnight: targetSquare\n        });\n        if (targetSquare === this.state.squaresToGo[this.state.actualSquareToGoIndex]) {\n          this.props.contextExercise.setSquares(\"squaresDone\", this.state.actualSquareToGoIndex);\n          this.setState({\n            actualSquareToGoIndex: this.state.actualSquareToGoIndex + 1,\n            actualSquareToGo: this.state.squaresToGo[this.state.actualSquareToGoIndex + 1],\n            squareStyles: {\n              [this.state.squaresToGo[this.state.actualSquareToGoIndex + 1]]: {\n                backgroundColor: \"rgba(255, 255, 0, 0.4)\"\n              }\n            }\n          });\n        }\n        ;\n        if (!this.props.timeIsActive) {\n          this.props.context.setTimer(\"playPauseTime\");\n        }\n      } else if (moveLikesKnight(sourceSquare, targetSquare)) {\n        this.props.context.setTimer(\"addPenalization\");\n      } else {\n        return;\n      }\n    };\n    this.onDrop = _ref2 => {\n      let {\n        sourceSquare,\n        targetSquare\n      } = _ref2;\n      this.moveTheKnight(sourceSquare, targetSquare);\n    };\n    this.onSquareClick = square => {\n      this.moveTheKnight(this.state.squareOfKnight, square);\n    };\n  }\n  componentDidMount() {\n    // this.game = new Chess(this.state.fen);\n\n    this.setState({\n      squareStyles: {\n        [this.state.squaresToGo[this.state.actualSquareToGoIndex]]: {\n          backgroundColor: \"rgba(255, 255, 0, 0.4)\"\n        }\n      }\n    });\n  }\n  componentDidUpdate() {\n    if (!this.props.timeIsActive && this.props.hasReseted) {\n      this.reset();\n      this.props.context.setTimerState({\n        ...this.props.context.timer,\n        hasReseted: false\n      });\n    }\n    if (this.hasEnded() && !this.props.hasEnded) {\n      this.props.context.setTimer(\"playPauseTime\");\n      this.props.context.setTimer(\"endGame\");\n    }\n  }\n  render() {\n    const {\n      position,\n      squareStyles\n    } = this.state;\n    return this.props.children({\n      squareStyles,\n      position: position,\n      onDrop: this.onDrop,\n      allowDrag: this.allowDrag,\n      onSquareClick: this.onSquareClick\n    });\n  }\n}\nChessPuzzle.propTypes = {\n  children: PropTypes.func\n};\nexport default function ChessPuzzleBoard(props) {\n  _s();\n  const context = useContext(props.context);\n  const contextExercise = useContext(props.contextExercise);\n  return /*#__PURE__*/_jsxDEV(ChessPuzzle, {\n    context: context,\n    exercise: props.exercise,\n    contextExercise: contextExercise,\n    timeIsActive: context.timer.timeIsActive,\n    hasReseted: context.timer.hasReseted,\n    hasEnded: context.timer.hasEnded,\n    penalizedMode: context.timer.penalizedMode,\n    children: _ref3 => {\n      let {\n        position,\n        onDrop,\n        allowDrag,\n        onSquareClick\n      } = _ref3;\n      return /*#__PURE__*/_jsxDEV(Chessboard, {\n        position: position,\n        onDrop: onDrop,\n        allowDrag: allowDrag,\n        orientation: props.orientation,\n        darkSquareStyle: {\n          backgroundColor: \"#769656\"\n        } // Салатовый темный цвет для темных клеток\n        ,\n        onSquareClick: onSquareClick,\n        calcWidth: _ref4 => {\n          let {\n            screenWidth\n          } = _ref4;\n          return Math.min(screenWidth - 32 - 8, 560);\n        }\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 145,\n        columnNumber: 5\n      }, this);\n    }\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 135,\n    columnNumber: 5\n  }, this);\n}\n_s(ChessPuzzleBoard, \"uwikWKGvBIjAhrXzJdMh8DHbMQg=\");\n_c = ChessPuzzleBoard;\nvar _c;\n$RefreshReg$(_c, \"ChessPuzzleBoard\");","map":{"version":3,"names":["React","Component","useContext","PropTypes","getSquarestoGo","getAllPiecesExceptKnight","moveLikesKnight","updateKnightInPosition","getSquareOfKnight","getInvalidSquaresByPosition","Chessboard","ChessPuzzle","state","position","props","exercise","squareOfKnight","OtherPieces","invalidSquares","squaresToGo","actualSquareToGoIndex","squareStyles","hasEnded","length","reset","setState","backgroundColor","contextExercise","setSquares","allowDrag","piece","moveTheKnight","sourceSquare","targetSquare","includes","actualSquareToGo","timeIsActive","context","setTimer","onDrop","onSquareClick","square","componentDidMount","componentDidUpdate","hasReseted","setTimerState","timer","render","children","propTypes","func","ChessPuzzleBoard","penalizedMode","orientation","screenWidth","Math","min"],"sources":["C:/Users/user/Documents/GitHub/NEw/src/integrations/ChessPuzzle.js"],"sourcesContent":["import React, { Component, useContext } from \"react\";\nimport PropTypes from \"prop-types\";\nimport {\n\tgetSquarestoGo,\n\tgetAllPiecesExceptKnight,\n\tmoveLikesKnight,\n\tupdateKnightInPosition,\n\tgetSquareOfKnight,\n  getInvalidSquaresByPosition,\n} from \"./functions\";\n// import { Chess } from \"chess.js\";\nimport Chessboard from \"chessboardjsx\";\n\n\n\n\n// code extracted and adapted from https://chessboardjsx.com/integrations/move-validation\nclass ChessPuzzle extends Component {\n  static propTypes = { children: PropTypes.func };\n  state = {\n    position: this.props.exercise.position,\n    squareOfKnight: getSquareOfKnight(this.props.exercise.position),\n    OtherPieces: getAllPiecesExceptKnight(this.props.exercise.position),\n    invalidSquares: getInvalidSquaresByPosition(this.props.exercise.position),\n    squaresToGo: getSquarestoGo(this.props.exercise),\n    actualSquareToGoIndex: 1,\n    squareStyles: {},\n  };\n\n\n  componentDidMount() {\n    // this.game = new Chess(this.state.fen);\n\n    this.setState({\n        squareStyles: { [this.state.squaresToGo[this.state.actualSquareToGoIndex]]: { backgroundColor: \"rgba(255, 255, 0, 0.4)\" } }\n      });\n\t\n  }\n\n  componentDidUpdate(){\n    if (!this.props.timeIsActive && this.props.hasReseted){\n        this.reset();\n        this.props.context.setTimerState({...this.props.context.timer, hasReseted: false});\n        \n    }\n    if (this.hasEnded() && !this.props.hasEnded){\n        this.props.context.setTimer(\"playPauseTime\");\n        this.props.context.setTimer(\"endGame\");\n    }\n    \n  }\n\n  hasEnded = () => {\n    return this.state.actualSquareToGoIndex === this.state.squaresToGo.length;\n  }\n\n  reset = () => {\n    const position = this.props.exercise.position;\n    const squaresToGo = getSquarestoGo(this.props.exercise);\n    this.setState({\n      position: position,\n      squareOfKnight: getSquareOfKnight(position),\n      OtherPieces: getAllPiecesExceptKnight(position),\n      invalidSquares: getInvalidSquaresByPosition(position),\n      squaresToGo: squaresToGo,\n      actualSquareToGoIndex: 1,\n      squareStyles: { [squaresToGo[1]]: { backgroundColor: \"rgba(255, 255, 0, 0.4)\" } }\n    });\n    this.props.contextExercise.setSquares(\"totalToGo\", squaresToGo.length - 1);\n  }\n\n  allowDrag = ({ piece }) => {\n    // we can only pick up the white knight\n    return piece === \"wN\";\n    };\n\n\n  moveTheKnight = (sourceSquare, targetSquare) => {\n    if (moveLikesKnight(sourceSquare, targetSquare) && !this.state.invalidSquares.includes(targetSquare)) {\n      this.setState({\n          position: updateKnightInPosition(this.props.exercise.position, targetSquare),\n          squareOfKnight: targetSquare,\n      });\n      if (targetSquare === this.state.squaresToGo[this.state.actualSquareToGoIndex]){\n        this.props.contextExercise.setSquares(\"squaresDone\", this.state.actualSquareToGoIndex);\n          this.setState({\n            actualSquareToGoIndex: this.state.actualSquareToGoIndex + 1,\n            actualSquareToGo: this.state.squaresToGo[this.state.actualSquareToGoIndex + 1],\n            squareStyles: { [this.state.squaresToGo[this.state.actualSquareToGoIndex + 1]]: { backgroundColor: \"rgba(255, 255, 0, 0.4)\" } }\n        });\n      };\n      if (!this.props.timeIsActive){\n        this.props.context.setTimer(\"playPauseTime\");\n      }\n      }\n    else if (moveLikesKnight(sourceSquare, targetSquare)){\n        this.props.context.setTimer(\"addPenalization\")\n    }\n      else {\n          return;\n      }\n    };\n\n  onDrop = ({ sourceSquare, targetSquare }) => {\n    this.moveTheKnight(sourceSquare, targetSquare);\n    \n  };\n\n  onSquareClick = square => {\n    this.moveTheKnight(this.state.squareOfKnight, square);\n  };\n\n\n\n\n  render() {\n    const { position, squareStyles } = this.state;\n\n    return this.props.children({\n      squareStyles,\n      position: position,\n      onDrop: this.onDrop,\n      allowDrag: this.allowDrag,\n      onSquareClick: this.onSquareClick,\n    });\n  }\n}\n\n\n\nexport default function ChessPuzzleBoard(props) {\n  const context = useContext(props.context);\n  const contextExercise = useContext(props.contextExercise);\n  return (\n    <ChessPuzzle\n  context={context}\n  exercise={props.exercise}\n  contextExercise={contextExercise}\n  timeIsActive={context.timer.timeIsActive}\n  hasReseted={context.timer.hasReseted}\n  hasEnded={context.timer.hasEnded}\n  penalizedMode={context.timer.penalizedMode}\n>\n  {({ position, onDrop, allowDrag, onSquareClick }) => (\n    <Chessboard\n      position={position}\n      onDrop={onDrop}\n      allowDrag={allowDrag}\n      orientation={props.orientation}\n      darkSquareStyle={{ backgroundColor: \"#769656\" }} // Салатовый темный цвет для темных клеток\n      onSquareClick={onSquareClick}\n      calcWidth={({ screenWidth }) => {\n        return Math.min(screenWidth - 32 - 8, 560);\n      }}\n    />\n  )}\n</ChessPuzzle>\n\n\n  );\n}"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}